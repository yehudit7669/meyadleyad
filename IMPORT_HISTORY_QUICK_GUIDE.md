# מערכת ניהול היסטוריית ייבוא - מדריך מהיר

## מה נוסף?

הוספנו מערכת מקיפה לניהול היסטוריית ייבוא עם האפשרויות הבאות:

### ✅ תכונות עיקריות:

1. **צפייה בהיסטוריית ייבוא**
   - כל הייבואים שבוצעו במערכת
   - סינון לפי סוג: נכסים, ערים ורחובות
   - פרטים: תאריך, שורות, הצלחות, כשלונות

2. **מחיקת ייבוא נכסים**
   - בדיקה אוטומטית: האם יש נכסים מאושרים?
   - שאלה למשתמש:
     * ✓ כן - מחק הכל (כולל מאושרים)
     * ✗ לא - מחק רק לא מאושרים

3. **מחיקת ייבוא ערים ורחובות**
   - בדיקה אוטומטית: האם יש נכסים מאושרים המשתמשים בערים/רחובות?
   - שאלה למשתמש:
     * ✓ כן - מחק ערים/רחובות כולל נכסים מאושרים
     * ✗ לא - מחק רק ערים/רחובות ללא נכסים מאושרים

## איך להשתמש?

### גישה למערכת
1. היכנס כמנהל
2. בתפריט צד שמאל: **"ייבוא ונתונים חיצוניים"**
3. לחץ על: **"היסטוריית ייבוא"**

### צפייה בייבואים
- רשימה של כל הייבואים
- סינון לפי סוג ייבוא
- עיון בפרטים

### מחיקת ייבוא
1. לחץ על כפתור "מחק" ליד הייבוא
2. המערכת בודקת אוטומטית אם יש נכסים מאושרים
3. אם יש - תוצג שאלה:
   - "האם למחוק גם נכסים מאושרים?"
4. בחר את האפשרות הרצויה
5. לחץ "מחק ייבוא"

## דוגמאות

### דוגמה 1: מחיקת ייבוא נכסים
```
📁 ייבוא: "import-properties-2026-01-26"
   ├─ 50 נכסים סה"כ
   ├─ 30 נכסים מאושרים ✓
   └─ 20 נכסים לא מאושרים ⏳

שאלה: האם למחוק גם נכסים מאושרים?
   
   אפשרות א': ✓ כן
   → ימחקו כל 50 הנכסים
   
   אפשרות ב': ✗ לא
   → ימחקו רק 20 הנכסים הלא מאושרים
   → 30 הנכסים המאושרים יישארו!
```

### דוגמה 2: מחיקת ייבוא ערים ורחובות
```
📁 ייבוא: "import-cities-2026-01-26"
   ├─ 10 ערים חדשות
   ├─ 50 רחובות חדשים
   └─ 25 נכסים מאושרים משתמשים בהם ⚠️

שאלה: האם למחוק כולל נכסים מאושרים?
   
   אפשרות א': ✓ כן
   → ימחקו 25 הנכסים
   → ואז ימחקו הערים והרחובות
   
   אפשרות ב': ✗ לא
   → רק ערים/רחובות ללא נכסים ימחקו
   → ערים/רחובות עם נכסים מאושרים יישארו!
```

## התקנה

### צעדים נדרשים:
```bash
# 1. הרצת Migration
cd server
npx prisma migrate dev --name add_import_tracking_fields

# 2. יצירת Prisma Client
npx prisma generate

# 3. הפעלת שרת מחדש
npm run dev
```

## מיקומים בקוד

### Backend:
- `server/src/modules/admin/import-history.service.ts` - לוגיקה עסקית
- `server/src/modules/admin/import-history.routes.ts` - API endpoints
- `server/prisma/schema.prisma` - עדכון מודל ImportLog

### Frontend:
- `client/src/pages/admin/ImportHistory.tsx` - עמוד ניהול
- `client/src/services/api.ts` - שירותי API

## תיעוד מלא
ראה: `IMPORT_HISTORY_SYSTEM.md`

---

**הוספה מוצלחת! המערכת מוכנה לשימוש! 🎉**
