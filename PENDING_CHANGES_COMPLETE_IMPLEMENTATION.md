# âœ… ××¢×¨×›×ª ×©×™× ×•×™×™× ×××ª×™× ×™× - ×”×˜××¢×” ××œ××”

## ğŸ“‹ ×¡×™×›×•×

×›×©××©×ª××© ×¢×•×¨×š ××•×“×¢×” ×©×›×‘×¨ ×××•×©×¨×ª (ACTIVE), ×”××•×“×¢×” ×”××§×•×¨×™×ª × ×©××¨×ª ×‘××ª×¨ ×•×”×©×™× ×•×™×™× × ×©××¨×™× ×‘× ×¤×¨×“ ×œ×”××ª× ×” ×œ××™×©×•×¨ ×× ×”×œ.

**×›×œ ×©×“×” ×©× ×™×ª×Ÿ ×œ×¢×¨×•×š ×‘××•×“×¢×” × ×©××¨ ×•××•×¦×’ ×œ×× ×”×œ ×œ×”×©×•×•××”!** âœ…

---

## ğŸ”§ ×©×“×•×ª ×©××˜×•×¤×œ×™×

### ×©×“×•×ª ×‘×¡×™×¡×™×™× (×‘×¨××ª Ad)
âœ… **×›×•×ª×¨×ª (title)** - ×›×•×ª×¨×ª ×”××•×“×¢×”  
âœ… **×ª×™××•×¨ (description)** - ×ª×™××•×¨ ××œ× ×©×œ ×”××•×“×¢×”  
âœ… **××—×™×¨ (price)** - ××—×™×¨ ×”××•×“×¢×”  
âœ… **×›×ª×•×‘×ª (address)** - ×›×ª×•×‘×ª ××“×•×™×§×ª  
âœ… **×©×›×•× ×” (neighborhood)** - ×©× ×”×©×›×•× ×”  
âœ… **×§×˜×’×•×¨×™×” (categoryId)** - ×§×˜×’×•×¨×™×™×ª ×”××•×“×¢×”  
âœ… **×¢×™×¨ (cityId)** - ×”×¢×™×¨ ×‘×” × ××¦× ×”× ×›×¡  
âœ… **×¨×—×•×‘ (streetId)** - ×”×¨×—×•×‘ ×‘×• × ××¦× ×”× ×›×¡  
âœ… **×ª××•× ×•×ª (images)** - ××¢×¨×š ×©×œ ×ª××•× ×•×ª ×¢× ×ª×¦×•×’×” ××§×“×™××”

### ×©×“×•×ª ××•×ª×××™× (customFields)
âœ… **×—×“×¨×™× (rooms)** - ××¡×¤×¨ ×—×“×¨×™× (× ×ª××š ×—×¦××™ ×—×“×¨)  
âœ… **×§×•××” (floor)** - ××¡×¤×¨ ×”×§×•××”  
âœ… **×©×˜×— (squareMeters)** - ×©×˜×— ×”× ×›×¡ ×‘××´×¨  
âœ… **××¡×¤×¨ ×‘×™×ª (houseNumber)** - ××¡×¤×¨ ×”×‘×™×ª ×‘×¨×—×•×‘  
âœ… **××¦×‘ ×”× ×›×¡ (condition)** - ×—×“×©, ××¦×•×™×Ÿ, ×˜×•×‘, ××ª×•×—×–×§, ××©×•×¤×¥, ×“×¨×•×© ×©×™×¤×•×¥, ×™×©×Ÿ  
âœ… **×¡×•×’ × ×›×¡ (propertyType)** - ×“×™×¨×”, ×‘×™×ª ×¤×¨×˜×™, ×“×™×¨×ª ×’×Ÿ, ×¤× ×˜×”××•×–, ×“×•×¤×œ×§×¡, ×¡×˜×•×“×™×•, ×§×•×˜×’×³, ×•×™×œ×”, ×‘×™×ª ×˜×•×¨×™  
âœ… **×¨×™×”×•×˜ (furniture)** - ×œ×œ×, ×—×œ×§×™, ××œ×, ××¨×•×”×˜, ×œ× ××¨×•×”×˜  
âœ… **××¨× ×•× ×” (arnona)** - ×ª×©×œ×•× ××¨× ×•× ×” ×—×•×“×©×™  
âœ… **×•×¢×“ ×‘×™×ª (vaad)** - ×ª×©×œ×•× ×•×¢×“ ×‘×™×ª ×—×•×“×©×™  
âœ… **×ª××¨×™×š ×›× ×™×¡×” (entryDate)** - ×ª××¨×™×š ×›× ×™×¡×” ××ª×•×›× ×Ÿ  
âœ… **×©× ××™×© ×§×©×¨ (contactName)** - ×©× ××™×© ×§×©×¨ × ×•×¡×£  
âœ… **×˜×œ×¤×•×Ÿ (contactPhone)** - ×˜×œ×¤×•×Ÿ ××™×© ×§×©×¨  
âœ… **×ª×•×¡×¤×ª ×œ×›×ª×•×‘×ª (addressSupplement)** - ×¤×¨×˜×™× × ×•×¡×¤×™× ×œ×›×ª×•×‘×ª

### ×××¤×™×™× ×™× (features)
âœ… **××¢×œ×™×ª (elevator)**  
âœ… **×—× ×™×” (parking)**  
âœ… **××—×¡×Ÿ (storage)**  
âœ… **××¨×¤×¡×ª (balcony / sukkaBalcony)**  
âœ… **×—×¦×¨ (yard)**  
âœ… **××™×–×•×’ ××•×•×™×¨ (airConditioning)**  
âœ… **× ×•×£ (view)**  
âœ… **×™×—×™×“×ª ×“×™×•×¨ (housingUnit)**  
âœ… **×××´×“ (safeRoom / mamad)**  
âœ… **×™×—×™×“×ª ×”×•×¨×™× (parentalUnit / masterUnit)**  
âœ… **××•×¤×¦×™×” (hasOption)**

#### ×××¤×™×™× ×™× ×œ×“×™×¨×•×ª × ×•×¤×©/×©×‘×ª:
âœ… **×¤×œ×˜×” (plata)**  
âœ… **××™×—× (urn)**  
âœ… **××¦×¢×™× (linens)**  
âœ… **×‘×¨×™×›×” (pool)**  
âœ… **××©×—×§×™ ×™×œ×“×™× (kidsGames)**  
âœ… **××™×˜×ª ×ª×™× ×•×§ (babyBed)**  
âœ… **×œ×™× ×” ×‘×œ×‘×“ (sleepingOnly)**

---

## ğŸ¨ ×ª×¦×•×’×ª ×”×©×™× ×•×™×™× ×œ×× ×”×œ

### ×¢×™×¦×•×‘ ×”×©×•×•××ª ×©×“×•×ª
×›×œ ×©×“×” ×©×”×©×ª× ×” ××•×¦×’ ×‘×¤×•×¨××˜:

```
ğŸ“‹ ×©× ×”×©×“×”

× ×•×›×—×™: ×¢×¨×š ×™×©×Ÿ (××•×¦×’ ×‘××“×•× ×¢× ×§×• ×—×•×¦×”)
×—×“×©:   ×¢×¨×š ×—×“×© (××•×¦×’ ×‘×™×¨×•×§ ××•×“×’×©)
```

### ×ª×¦×•×’×ª ×ª××•× ×•×ª
×ª××•× ×•×ª ××•×¦×’×•×ª ×¢×:
- **×¡×¤×™×¨×”**: "× ×•×›×—×™: 5 ×ª××•× ×•×ª" â†’ "×—×“×©: 7 ×ª××•× ×•×ª"
- **×ª×¦×•×’×” ××§×“×™××”**: grid ×©×œ ×¢×“ 6 ×ª××•× ×•×ª ×¨××©×•× ×•×ª
- **×ª××•× ×•×ª × ×•×›×—×™×•×ª**: opacity 50%, ×’×‘×•×œ ×¨×’×™×œ
- **×ª××•× ×•×ª ×—×“×©×•×ª**: ×’×‘×•×œ ×™×¨×•×§, ×œ×œ× opacity
- **×¡××Ÿ ×¢×•×“ ×ª××•× ×•×ª**: ×× ×™×© ×™×•×ª×¨ ×-6

---

## ğŸ”„ ×ª×”×œ×™×š ×”×¢×‘×•×“×”

### 1ï¸âƒ£ ××©×ª××© ×¢×•×¨×š ××•×“×¢×” ×××•×©×¨×ª
```typescript
// client/src/pages/EditAd.tsx
updateMutation.mutate({
  title: formData.title,
  description: formData.description,
  price: formData.price,
  categoryId: formData.categoryId,
  adType: formData.adType,
  cityId: formData.cityId,
  streetId: formData.streetId,
  customFields: customFieldsToSave,
  images: formData.images,
});
```

### 2ï¸âƒ£ ×”×©×¨×ª ×©×•××¨ ×œ×©×™× ×•×™×™× ×××ª×™× ×™×
```typescript
// server/src/modules/ads/ads.service.ts - updateAd()
if (ad.status === AdStatus.ACTIVE) {
  const pendingChanges = {
    ...data,
    neighborhood,
    requestedAt: new Date().toISOString(),
    requestedBy: userId,
  };

  const updatedAd = await prisma.ad.update({
    where: { id: adId },
    data: {
      hasPendingChanges: true,
      pendingChanges: pendingChanges,
      pendingChangesAt: new Date(),
    },
    // ...
  });
}
```

**×”××•×“×¢×” ×”××§×•×¨×™×ª ×œ× ××©×ª× ×”!** âœ…

### 3ï¸âƒ£ ×× ×”×œ ×¨×•××” ×©×™× ×•×™×™× ×××ª×™× ×™×
- ×‘×“×£ ×”××•×“×¢×•×ª ×”×××ª×™× ×•×ª: `/admin/pending-changes`
- ×ª×’ ğŸŸ  ××¡×•××Ÿ ×¢×œ ××•×“×¢×•×ª ×¢× `hasPendingChanges: true`
- ×œ×—×™×¦×” ×¢×œ "×”×¦×’ ×©×™× ×•×™×™×" ×¤×•×ª×—×ª ××•×“××œ ×”×©×•×•××”

### 4ï¸âƒ£ ×× ×”×œ ×××©×¨ ××• ×“×•×—×”

#### ××™×©×•×¨ ×©×™× ×•×™×™×:
```typescript
// server/src/modules/admin/admin.service.ts - approvePendingChanges()

// 1. ×¢×“×›×•×Ÿ ×ª××•× ×•×ª (×× ×™×©)
if (pendingChanges.images && Array.isArray(pendingChanges.images)) {
  await prisma.adImage.deleteMany({ where: { adId } });
  await prisma.adImage.createMany({
    data: pendingChanges.images.map((img, index) => ({
      adId,
      url: img.url,
      order: img.order ?? index,
    })),
  });
}

// 2. ×¢×“×›×•×Ÿ ×›×œ ×©××¨ ×”×©×“×•×ª
const updatedAd = await prisma.ad.update({
  where: { id: adId },
  data: {
    title: pendingChanges.title || ad.title,
    description: pendingChanges.description ?? ad.description,
    price: pendingChanges.price ?? ad.price,
    categoryId: pendingChanges.categoryId || ad.categoryId,
    cityId: pendingChanges.cityId || ad.cityId,
    streetId: pendingChanges.streetId || ad.streetId,
    customFields: pendingChanges.customFields || ad.customFields,
    // ...
    hasPendingChanges: false,
    pendingChanges: null,
    pendingChangesAt: null,
  },
});
```

#### ×“×—×™×™×ª ×©×™× ×•×™×™×:
```typescript
// server/src/modules/admin/admin.service.ts - rejectPendingChanges()
const updatedAd = await prisma.ad.update({
  where: { id: adId },
  data: {
    hasPendingChanges: false,
    pendingChanges: null,
    pendingChangesAt: null,
  },
});
```

---

## ğŸ“ ×§×‘×¦×™× ×©×”×©×ª× ×•

### Backend
1. **server/prisma/schema.prisma**
   - ×”×•×¡×¤×ª `hasPendingChanges: Boolean`
   - ×”×•×¡×¤×ª `pendingChanges: Json?`
   - ×”×•×¡×¤×ª `pendingChangesAt: DateTime?`

2. **server/src/modules/ads/ads.service.ts**
   - ×©×™× ×•×™ `updateAd()` ×œ×©××•×¨ ×œ-pendingChanges ×‘××§×•× ×¢×“×›×•×Ÿ ×™×©×™×¨
   - ×ª××™×›×” ×‘×¤×¨××˜×¨ `images` ×‘×˜×™×¤×•×¡

3. **server/src/modules/admin/admin.service.ts**
   - `getAdsWithPendingChanges()` - ××‘×™× ××•×“×¢×•×ª ×¢× ×©×™× ×•×™×™× ×××ª×™× ×™×
   - `approvePendingChanges()` - ×××©×¨ ×©×™× ×•×™×™× (×›×•×œ×œ ×˜×™×¤×•×œ ×‘×ª××•× ×•×ª)
   - `rejectPendingChanges()` - ×“×•×—×” ×©×™× ×•×™×™×

4. **server/src/modules/admin/admin.controller.ts**
   - endpoints ×—×“×©×™× ×¢×‘×•×¨ ×¤×¢×•×œ×•×ª ×©×™× ×•×™×™× ×××ª×™× ×™×

5. **server/src/modules/admin/admin.routes.ts**
   - `GET /api/admin/ads/pending-changes`
   - `POST /api/admin/ads/:id/approve-changes`
   - `POST /api/admin/ads/:id/reject-changes`

### Frontend
1. **client/src/services/api.ts**
   - `getPendingChanges()`
   - `approvePendingChanges()`
   - `rejectPendingChanges()`

2. **client/src/pages/admin/PendingChangesPage.tsx**
   - ×“×£ ××œ× ×¢× ×¨×©×™××” ×•×—×œ×•×Ÿ ×”×©×•×•××”
   - ×ª××™×›×” ×‘×›×œ ×”×©×“×•×ª ×›×•×œ×œ ×ª××•× ×•×ª
   - ×¢×™×¦×•×‘ "×œ×¤× ×™ â† ××—×¨×™"

3. **client/src/components/admin/AdminLayout.tsx**
   - ×¤×¨×™×˜ ×ª×¤×¨×™×˜ ×¢× ×ª×’ Badge ×œ××¡×¤×¨ ×©×™× ×•×™×™× ×××ª×™× ×™×

4. **client/src/App.tsx**
   - × ×ª×™×‘ `/admin/pending-changes`

---

## âœ… ×‘×“×™×§×•×ª ×©×‘×•×¦×¢×•

- [x] ×›×œ ×”×©×“×•×ª ×”×‘×¡×™×¡×™×™× × ×©××¨×™× ×‘-pendingChanges
- [x] customFields × ×©××¨ ×›×•×œ×œ features
- [x] ×ª××•× ×•×ª × ×©××¨×•×ª ×•××•×¦×’×•×ª
- [x] ×”××•×“×¢×” ×”××§×•×¨×™×ª × ×©××¨×ª ×¤×¢×™×œ×”
- [x] ×× ×”×œ ×¨×•××” ××ª ×›×œ ×”×©×™× ×•×™×™×
- [x] ××™×©×•×¨ ××—×™×œ ××ª ×›×œ ×”×©×™× ×•×™×™× ×›×•×œ×œ ×ª××•× ×•×ª
- [x] ×“×—×™×™×” ××•×—×§×ª ××ª ×”×©×™× ×•×™×™× ×”×××ª×™× ×™×
- [x] ×ª×¦×•×’×ª ×”×©×•×•××” ×‘×¨×•×¨×” ×¢× ×¢×™×¦×•×‘

---

## ğŸš€ ××™×š ×œ×”×©×ª××©

### ×›××©×ª××©
1. ×¢×‘×•×¨ ×œ××•×“×¢×” ×©×œ×š ×©×›×‘×¨ ×××•×©×¨×ª
2. ×œ×—×¥ "×¢×¨×•×š ××•×“×¢×”"
3. ×¢×¨×•×š ×›×œ ×©×“×” ×©×¨×•×¦×” (×›×•×ª×¨×ª, ×ª×™××•×¨, ××—×™×¨, ×ª××•× ×•×ª, ×•×›×•')
4. ×©××•×¨
5. ×”××•×“×¢×” ×”××§×•×¨×™×ª × ×©××¨×ª ×‘××ª×¨ ×œ×œ× ×©×™× ×•×™ âœ…
6. ×”×©×™× ×•×™×™× ×©×œ×š ×××ª×™× ×™× ×œ××™×©×•×¨ ×× ×”×œ

### ×›×× ×”×œ
1. ×¢×‘×•×¨ ×œ-"×©×™× ×•×™×™× ×××ª×™× ×™×" ×‘×ª×¤×¨×™×˜
2. ×¨×©×™××” ×©×œ ×›×œ ×”××•×“×¢×•×ª ×¢× ×©×™× ×•×™×™× ×××ª×™× ×™×
3. ×œ×—×¥ "×”×¦×’ ×©×™× ×•×™×™×" ×¢×œ ×›×œ ××•×“×¢×”
4. ×¨××” ×”×©×•×•××” ××“×•×™×§×ª ×©×œ ×›×œ ×©×“×” ×©×”×©×ª× ×”
5. ××©×¨ ××• ×“×—×”

---

## ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×”

**×¡×”×´×› ×©×“×•×ª × ×ª××›×™×**: 30+  
**×›×•×œ×œ ×××¤×™×™× ×™×**: 20+  
**×ª××™×›×” ×‘×ª××•× ×•×ª**: âœ… ××œ××”  
**×ª××™×›×” ×‘-customFields ××§×•× × ×™×**: âœ… features  

---

## ğŸ¯ ××˜×¨×•×ª ×©×”×•×©×’×•

âœ… **×©××™×¨×ª ×”××•×“×¢×” ×”××§×•×¨×™×ª** - ×”××•×“×¢×” × ×©××¨×ª ×¤×¢×™×œ×” ×‘×“×™×•×§ ×›××• ×©×”×™×  
âœ… **×›×™×¡×•×™ ××œ× ×©×œ ×©×“×•×ª** - ×›×œ ×©×“×” ×©× ×™×ª×Ÿ ×œ×¢×¨×•×š × ×ª××š  
âœ… **×ª××•× ×•×ª ××œ××•×ª** - ×›×•×œ×œ ×ª×¦×•×’×” ××§×“×™××”  
âœ… **×—×•×•×™×™×ª UX ×˜×•×‘×”** - ×”×©×•×•××” ×‘×¨×•×¨×” ×¢× ×¦×‘×¢×™×  
âœ… **×‘×˜×™×—×•×ª** - ×¨×§ ×× ×”×œ ×™×›×•×œ ×œ××©×¨/×œ×“×—×•×ª  

---

**×ª××¨×™×š ×™×¦×™×¨×”**: 2026-01-14  
**×’×¨×¡×”**: 1.0.0  
**×¡×˜×˜×•×¡**: âœ… ×”×•×©×œ× ×‘××œ×•××•
